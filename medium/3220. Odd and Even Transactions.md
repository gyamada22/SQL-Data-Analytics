# 3220. Odd and Even Transactions

**Data:** 21/01  
**Dificuldade:** Medium  
**Tópicos:** SQL, CTE, GROUP BY, CASE, Aggregation  
**Link:** https://leetcode.com/problems/odd-and-even-transactions/description/?envType=problem-list-v2&envId=vszzv79m  

## Descrição
O objetivo é, para cada data de transação, calcular separadamente:

- A soma dos valores **ímpares** (`odd_sum`);
- A soma dos valores **pares** (`even_sum`).

Assim, conseguimos analisar como os valores das transações se distribuem entre números pares e ímpares em cada dia.

---

## Solução (SQL Server)
```sql
WITH qwe AS (
    SELECT  
        transaction_date,
        SUM(CASE WHEN amount % 2 <> 0 THEN amount ELSE 0 END) AS odd_sum
    FROM transactions
    GROUP BY transaction_date
),
qwer AS (
    SELECT  
        transaction_date,
        SUM(CASE WHEN amount % 2 = 0 THEN amount ELSE 0 END) AS even_sum
    FROM transactions
    GROUP BY transaction_date
)

SELECT  
    qwer.transaction_date,
    qwe.odd_sum,
    qwer.even_sum
FROM qwe
JOIN qwer 
  ON qwe.transaction_date = qwer.transaction_date;
