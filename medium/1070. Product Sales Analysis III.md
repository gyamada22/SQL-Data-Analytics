# 1070. Product Sales Analysis III

**Data:** 19/12/2025  
**Dificuldade:** Medium  
**Tópicos:** SQL, CTE, MIN, GROUP BY, JOIN  
**Link:** https://leetcode.com/problems/product-sales-analysis-iii/description/?envType=study-plan-v2&envId=top-sql-50

## Descrição
Escreva uma solução para encontrar, para cada produto, o **primeiro ano em que ele foi vendido**, juntamente com a **quantidade** e o **preço** correspondentes a esse ano inicial de venda.

## Solução (SQL Server)

```sql
WITH first_year_sales AS (
    SELECT
        product_id,
        MIN(year) AS first_year
    FROM sales
    GROUP BY product_id
)
SELECT
    s.product_id,
    f.first_year,
    s.quantity,
    s.price
FROM first_year_sales f
JOIN sales s
    ON f.product_id = s.product_id
   AND s.year = f.first_year;
