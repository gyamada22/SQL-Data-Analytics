# 1204. Last Person to Fit in the Bus

**Data:** 22/12/2025  
**Dificuldade:** Medium  
**Tópicos:** SQL, Window Functions, SUM, ORDER BY  
**Link:** https://leetcode.com/problems/last-person-to-fit-in-the-bus/description/?envType=study-plan-v2&envId=top-sql-50

## Descrição
Dada uma fila de pessoas (`Queue`) com seus pesos e a ordem (`turn`), encontre a **última pessoa que pode entrar no ônibus** sem que a soma total de pesos ultrapasse 1000.

## Solução (SQL Server)

```sql
WITH qwe AS (
    SELECT *,
           SUM(weight) OVER (ORDER BY turn ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS asd
    FROM Queue
)
SELECT TOP 1 person_name
FROM qwe
WHERE asd <= 1000
ORDER BY turn DESC
