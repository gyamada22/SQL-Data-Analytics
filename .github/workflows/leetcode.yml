name: LeetCode Custom Heatmap
on:
  workflow_dispatch:
    # Permite rodar manualmente
  schedule:
    - cron: '0 2 * * *'  # 02:00 UTC todo dia

jobs:
  generate-heatmap:
    runs-on: ubuntu-latest
    permissions:
      contents: write
      
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          
      - name: Generate Custom Heatmap SVG
        run: |
          # Crie um SVG SIMPLES primeiro para testar
          cat > leetcode-heatmap.svg << 'EOF'
          <svg width="700" height="200" xmlns="http://www.w3.org/2000/svg">
            <!-- Fundo -->
            <rect width="700" height="200" fill="#0d1117"/>
            
            <!-- TÃ­tulo -->
            <text x="20" y="30" fill="#c9d1d9" font-family="Arial" font-size="16" font-weight="bold">
              ðŸŸ© LeetCode Activity Heatmap (Since Dec 2025)
            </text>
            
            <!-- Stats -->
            <text x="20" y="60" fill="#8b949e" font-family="Arial" font-size="12">
              <tspan fill="#2ea043">10</tspan> active days in December 2025
            </text>
            
            <text x="20" y="80" fill="#8b949e" font-family="Arial" font-size="12">
              <tspan fill="#f66a0a">7 days</tspan> max streak â€¢ <tspan fill="#0366d6">78</tspan> total submissions
            </text>
            
            <!-- Heatmap Simulado -->
            <text x="20" y="110" fill="#c9d1d9" font-family="Arial" font-size="12">
              December 2025 Activity:
            </text>
            
            <!-- Grid de dias (simulaÃ§Ã£o) -->
            <g transform="translate(20, 130)">
              <!-- Legend -->
              <text y="-5" fill="#8b949e" font-size="9">Mon</text>
              <text y="15" fill="#8b949e" font-size="9">Wed</text>
              <text y="35" fill="#8b949e" font-size="9">Fri</text>
              <text y="55" fill="#8b949e" font-size="9">Sun</text>
              
              <!-- Week labels -->
              <text x="40" y="-10" fill="#8b949e" font-size="9">Dec 1-7</text>
              <text x="120" y="-10" fill="#8b949e" font-size="9">Dec 8-14</text>
              
              <!-- Dias ativos (10 dias - personalize!) -->
              <!-- Semana 1 -->
              <rect x="40" y="0" width="10" height="10" fill="#196127" title="Dec 1: 3 problems"/>
              <rect x="52" y="0" width="10" height="10" fill="#26a641" title="Dec 2: 5 problems"/>
              <rect x="64" y="10" width="10" height="10" fill="#30a14e" title="Dec 3: 4 problems"/>
              
              <!-- Semana 2 -->
              <rect x="120" y="0" width="10" height="10" fill="#196127" title="Dec 8: 3 problems"/>
              <rect x="132" y="10" width="10" height="10" fill="#26a641" title="Dec 9: 5 problems"/>
              <rect x="144" y="20" width="10" height="10" fill="#30a14e" title="Dec 10: 4 problems"/>
              
              <!-- Continue com os 10 dias... -->
            </g>
            
            <!-- Legenda de cores -->
            <g transform="translate(400, 130)">
              <text fill="#8b949e" font-size="10">Less</text>
              <rect x="40" y="-8" width="10" height="10" fill="#161b22"/>
              <rect x="55" y="-8" width="10" height="10" fill="#0e4429"/>
              <rect x="70" y="-8" width="10" height="10" fill="#196127"/>
              <rect x="85" y="-8" width="10" height="10" fill="#26a641"/>
              <rect x="100" y="-8" width="10" height="10" fill="#30a14e"/>
              <text x="120" fill="#8b949e" font-size="10">More</text>
            </g>
            
            <!-- RodapÃ© -->
            <text x="20" y="180" fill="#8b949e" font-family="Arial" font-size="10">
              Updated: $(date -u +"%Y-%m-%d %H:%M UTC") â€¢ Data starts from December 2025
            </text>
          </svg>
          EOF
          
          # Substitua a data atual
          CURRENT_DATE=$(date -u +"%Y-%m-%d %H:%M UTC")
          sed -i "s/\$(date -u +\"%Y-%m-%d %H:%M UTC\")/${CURRENT_DATE}/g" leetcode-heatmap.svg
          
      - name: Commit and Push Heatmap
        run: |
          git config --global user.name "github-actions[bot]"
          git config --global user.email "github-actions[bot]@users.noreply.github.com"
          git add leetcode-heatmap.svg
          git commit -m "ðŸŸ© Update LeetCode heatmap visualization" || echo "No changes to commit"
          git push
