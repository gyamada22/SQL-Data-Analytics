# 1693. Daily Leads and Partners

**Data:** 28/12/2025  
**Dificuldade:** Easy  
**Tópicos:** SQL, CTE, GROUP BY, COUNT, DISTINCT  
**Link:** https://leetcode.com/problems/daily-leads-and-partners/description/?source=submission-ac

## Descrição
Dado o histórico de vendas diárias (`DailySales`), escreva uma query para retornar, para cada combinação de dia (`date_id`) e marca (`make_name`):

1. O número de **leads únicos** (`unique_leads`)
2. O número de **parceiros únicos** (`unique_partners`)

A saída deve listar os campos na seguinte ordem:
- `date_id`
- `make_name`
- `unique_leads`
- `unique_partners`

---

## Solução (SQL Server)

A estratégia é agregar os dados por `date_id` e `make_name`, contando valores distintos de `lead_id` e `partner_id` para garantir que sejam considerados apenas *leads* e *parceiros únicos*. Utilizamos uma CTE com nome mais amigável para melhorar a legibilidade.

```sql
WITH daily_aggregates AS (
    SELECT
        date_id,
        make_name,
        COUNT(DISTINCT lead_id)    AS total_unique_leads,
        COUNT(DISTINCT partner_id) AS total_unique_partners
    FROM DailySales
    GROUP BY date_id, make_name
)
SELECT
    date_id,
    make_name,
    total_unique_leads    AS unique_leads,
    total_unique_partners AS unique_partners
FROM daily_aggregates;
