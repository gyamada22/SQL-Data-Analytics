# 1661. Average Time of Process per Machine

**Data:** 12/12/2025  
**Dificuldade:** Easy  
**Tópicos:** SQL, Self Join, AVG, ROUND, Timestamp Calculation  
**Link:** [Average Time of Process per Machine - LeetCode](https://leetcode.com/problems/average-time-of-process-per-machine/)

## Descrição
Existe uma fábrica com várias máquinas que executam processos. Escreva uma solução para encontrar o tempo médio que cada máquina leva para completar um processo. O tempo para completar um processo é o tempo 'end' menos o tempo 'start'. Retorne a tabela de resultados com `machine_id` e `processing_time` (média com 3 casas decimais).

## Solução (SQL Server)

```sql
select 
    a1.machine_id,
    ROUND(AVG(a2.timestamp - a1.timestamp), 3) as processing_time
from Activity a1
join Activity a2 
    on a1.machine_id = a2.machine_id
    and a1.process_id = a2.process_id
    and a1.activity_type = 'start'
    and a2.activity_type = 'end'
group by a1.machine_id
