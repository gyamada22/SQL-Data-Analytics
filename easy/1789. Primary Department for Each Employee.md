1789. Primary Department for Each Employee

https://leetcode.com/problems/primary-department-for-each-employee/description/?envType=study-plan-v2&envId=top-sql-50

with qwe as(
    select *,
    row_number()over(partition by employee_id order by primary_flag desc) as qwer
from employee
)
select  employee_id,
        department_id 
from qwe 
where qwer = 1
