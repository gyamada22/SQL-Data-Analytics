# 1789. Primary Department for Each Employee

**Data:** 15/12/2025  
**Dificuldade:** Easy  
**Tópicos:** SQL, CTE, Window Function  
**Link:** https://leetcode.com/problems/primary-department-for-each-employee/description/?envType=study-plan-v2&envId=top-sql-50

## Descrição
Escreva uma solução para reportar o department_id primário de cada funcionário. Se um funcionário estiver associado a apenas um departamento, este deve ser considerado como primário.

## Solução (SQL Server)

```sql
WITH qwe AS (
    SELECT
        *,
        ROW_NUMBER() OVER (
            PARTITION BY employee_id
            ORDER BY primary_flag DESC
        ) AS qwer
    FROM employee
)
SELECT
    employee_id,
    department_id
FROM qwe
WHERE qwer = 1;
